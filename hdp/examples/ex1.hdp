
---- Unidades

ğŸ˜ : Type
ğŸ˜ = âˆ€ X : X

Î´ğŸ˜ : âˆ€ X : ğŸ˜ â†’ X
Î´ğŸ˜ X f = f X

ğŸ™ : Type
ğŸ™ = âˆ€ X : X â†’ X

iğŸ™ : ğŸ™
iğŸ™ X x = x

Î´ğŸ™ : âˆ€ X : X â†’ ğŸ™ â†’ X
Î´ğŸ™ X x u = u X x

âŠ¤ : Type
âŠ¤ = âˆ€ X : (âˆ€ Y : Y â†’ X) â†’ X

iâŠ¤ : âŠ¤
iâŠ¤ X f = f ğŸ™ iğŸ™

---- Proyecciones

Ï€â‚ : âˆ€ A B : (A & B) â†’ A
Ï€â‚ A B p = Î´&â‚ p (x:x)

Ï€â‚‚ : âˆ€ A B : (A & B) â†’ B
Ï€â‚‚ A B p = Î´&â‚‚ p (x:x)

---- Naturales

Nat : Type
Nat = âˆ€ X : X â†’ !(X â†’ X) â†’ X

zero : Nat
zero X z f = Î´! f (f': z)

suc : Nat â†’ Nat
suc n X z f = Î´! f (f': f' (n X z (!f')))

pred : Nat â†’ Nat
pred n = Ï€â‚‚ Nat Nat
            (n (Nat & Nat)
               (zero, zero)
               (! (Î» p â†’ (suc (Ï€â‚ Nat Nat p), Ï€â‚ Nat Nat p))))

---- Listas multiplicativas

-- Usamos el hecho de que un mÃ­nimo punto fijo ÂµX.A
-- se puede codificar con cuantificadores de segundo orden como
--   âˆ€ X : !(A â†’ X) â†’ X
-- (cf. Baelde. Least and Greatest Fixed Points in Linear Logic).

List : Type â†’ Type
List A = âˆ€ X : !(((A âŠ— X) âŠ• ğŸ™) â†’ X) â†’ X

nil : âˆ€ A : List A
nil A X f = Î´! f (f': f' (inr iğŸ™))

cons : âˆ€ A : A â†’ List A â†’ List A
cons A x xs X f = Î´! f (f': f' (inl (x âŠ— xs X (!f'))))

length : âˆ€ A : List (!A) â†’ Nat
length A xs = xs Nat (!(Î» p â†’
                        Î´âŠ• p (x: Î´âŠ— x (y z: Î´! y (y': suc z)))
                             (x: Î´ğŸ™ Nat zero x)))

eval length Nat (cons (!Nat) (!zero)
                  (cons (!Nat) (!zero)
                    (cons (!Nat) (!zero)
                      (nil (!Nat)))))

